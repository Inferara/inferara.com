+++
title = "UniswapX と 1inch Fusion で実現する Pocket Exchange"
date = 2025-11-12T16:22:00+09:00
draft = false
summary = "本稿は、UniswapX の RFQ→排他→公開ダッチという二段階型と 1inch Fusion の古典的ダッチ方式を比較し、インテント型スワップが MEV・失敗・流動性分断を抑える仕組みを要約します。"
tags = ["DeFi", "Uniswap", "1inch", "マーケットメイキング", "自動マーケットメイカー", "AMM", "流動性提供", "暗号トレーディングボット"]
aliases = ["/blog/pocket-exchange"]
+++

**目次**

- [はじめに {#introduction}](#はじめに-introduction)
- [UniswapX と 1inch Fusion {#uniswapx-and-1inch-fusion}](#uniswapx-と-1inch-fusion-uniswapx-and-1inch-fusion)
- [1inch Fusion：古典的なダッチオークション {#1inch-fusion-the-classic-dutch-auction}](#1inch-fusion古典的なダッチオークション-1inch-fusion-the-classic-dutch-auction)
- [Uniswap X：2 段階の差別化オークション {#uniswap-x-a-two-stage-differentiated-auction}](#uniswap-x2-段階の差別化オークション-uniswap-x-a-two-stage-differentiated-auction)
- [学び {#learnings}](#学び-learnings)
- [モニタリング \& データ取得 {#monitoring--data-acquisition}](#モニタリング--データ取得-monitoring--data-acquisition)
  - [クエリの構成要素とその意味 {#the-query-parts--their-significance}](#クエリの構成要素とその意味-the-query-parts--their-significance)
  - [結論：「サーバーサイド SQL」の価値提案 {#conclusion-the-server-side-sql-value-proposition}](#結論サーバーサイド-sqlの価値提案-conclusion-the-server-side-sql-value-proposition)
- [好機をつかむ：研究から収益へ {#seizing-the-opportunity-from-research-to-revenue}](#好機をつかむ研究から収益へ-seizing-the-opportunity-from-research-to-revenue)
- [研究チームではなく、市場のリーダーに。 {#become-a-market-leader-not-a-research-team}](#研究チームではなく市場のリーダーに-become-a-market-leader-not-a-research-team)

## はじめに {#introduction}

本稿では、完了済みのリサーチプロジェクトから得られた知見と発見の一部を共有します。私たちは、トレーディングにおけるゲーム理論の観点から UniswapX プロトコルの経済モデルを算定するために依頼されました。UniswapX や類似プロトコルの発想は極めて興味深く、巨額の資本を持つプレイヤーが、プロトコルや流動性提供者（LP）のリスクを抑えつつマーケットメイキングに参加できる点に魅力があります。オーダーブックを自ら管理せず、Uniswap によって提示される注文を**充足**するだけの取引所を通じて、資本を効率的に使いたい方にとって、本稿は良い出発点となるでしょう。

金融サービスの分散化は新たなデジタル経済の不可欠な要素となりましたが、多くの利点と同時に、いくつかの課題ももたらしました。つい最近まで、これらの課題は、あるデジタルアセットから別のアセットへ流動性を移す必要があるすべての人を悩ませてきました。分散型暗号資産取引所（DEX）の一般ユーザーは長年、他人のスワップを「サンドイッチ」するボット、ネットワーク負荷の急増に伴う手数料の高騰、スワップ画面の見積りを実質的に無意味にする不可測なスリッページといったおなじみの頭痛の種に直面してきました。初期世代の AMM（Uniswap V2/V3）は、受動的流動性提供の課題には対処したものの、スワップ実行そのものに内在する欠陥を十分に補正したわけではありません。

状況が本質的に変わり始めたのは、**インテントベース**のスワップ機構という急進的な新しいパラダイムの台頭からです。従来方式では、トランザクションの準備責任はスワップの発起者にあり（サービスは、取引が許容できる場合に資金を解放するための署名を行うだけ）、インテントプロトコルでは、ユーザーは準備されたトランザクションやその周辺条件の詳細から完全に抽象化できます。あるトークン X を少なくともトークン Y と交換したいという**意図**への署名により、その他のすべての意思決定はサービスに委ねられ、スマートコントラクトによる保証のおかげで信頼不要に遂行されます。堅牢なアーキテクチャであれば、サービスも選ばれた相手方も、ユーザーの宣言した意図から外れたパラメータでトランザクションを実行することはできません。

ここでは、このアーキテクチャ思想の最も影響力のある 2 つの具現化――**Uniswap X** と **1inch Fusion**――を比較します。両者は古典的な**ダッチオークション**という堅固な基盤の上に立ちながら、実装の細部において経済的にも興味深い差異を見せます。

## UniswapX と 1inch Fusion {#uniswapx-and-1inch-fusion}

> 本稿公開時点の最新版として、UniswapX V2 がメインネットにデプロイされています。
> {.note}

通常どおり、V1 と V2 の包括的なドキュメントは Uniswap のドキュメントサイトにあります。

まず、両システムが是正を目指す従来ワークフローの課題を確認しましょう。標準的な取引（取引所でもエスクロー経由の p2p でも）では、発起者が事実上プロセス全体を**自力で**こなします。すなわち、十分な深さのある流動性ソース（大口取引なら複数）を見つけ、（初回はネットワーク手数料を払って）トークンをエスクローまたは取引所に送金し、為替レートをロック（不利なら中止）し、最後に、やはり自分の負担で、受け取り金（あるいは未使用の入力トークン）をウォレットへ引き出します。満額受け取れるかは、**各**流動性ソースでの処理成功に依存します。どこかでレートが大きく滑れば、トレーダーは sunk cost を抱えたまま別の流動性を探すことになります。これには手数料、価格変動、機会損失などが含まれ得ます。また、流動性ソースを選んでから実際にレートをロックするまでの**時間差**は、相手方に MEV（最大抽出可能価値）を狙った価格操作の誘惑を与えてしまいます。この不運な現状は、いくつかの切迫した問いを突きつけます。

• **MEV 脅威**：実行順序の操作で他者の取引から価値を略奪するボットから、ユーザーを保護できるか？
• **流動性の分断**：多数の取引所やプライベート在庫に散らばる**何百もの**流動性ソースへ、統合の複雑さを隠蔽した**シンプルで低コスト**な 1 回の操作でアクセスさせられるか？
• **サンクコストのリスク**：何らかの理由で失敗した取引に対し、ユーザーが費用を払わずに済むか？

1inch Fusion と Uniswap X は、これらの問いに**ほぼ同様の**答えを示します。スワップ注文を**プロの実行者間のオークション**として再定式化するのです。クライアントに奉仕する権利を巡って相手方に競争させることは、一挙に複数の課題を解決します。

• **失敗トランザクションからの保護**：このモデルではユーザーはトランザクションを準備しません。指定パラメータの注文に対して最適な実行者を探す**指示**に、無料で署名するだけです。ネットワーク手数料や失敗時の潜在損失は**市場スプレッドに内在化**され、実行者は競争圧力の下でリスクを正確に価格付けすることにより、それを最小化します。

• **MEV をクライアントの利益へ**：マーケットメイカーの正当な利潤最大化は、競争という自然な歯止めと組み合わさって、陰から陽へ出てきます。契約書に記載された価格は、資金がユーザーのウォレットを出る前に固定され、**価格操作の時間窓**を残しません。最良のスプレッドを提示した者が実行します。

• **分断流動性の透明な集約**：この仕組みは**当事者間の契約**を強制するだけで、実行者に共通プールへ事前入金を求めません。トークンの**出どころがどこであれ**、期限内にクライアントのウォレットへ届けばよい――それがオークションの観点です。これにより、実行者は市場のあらゆる流動性を**単一窓口**から事実上リセールできます。

この経済モデルが発起者のスワップを劇的に単純化する一方で、**実行者の側は複雑になる**ことは見逃せません。古典的な取引所（流動性を入れて価格を掲示し、買い手を受動的に待つだけ）と違い、オークション方式では、実行側はタイトな期限のもと**意思決定項目が激増**します。**自動化は不可欠**です。厳しい応答時間と、常時スタンバイ状態を作る必要があり、人間がロボットに勝つ余地はありません。以下では、両プラットフォームにおいて**どのような経済的意思決定**が自動化を必然にするのかを掘り下げます。

1inch Fusion と Uniswap X は、概略では同じ中核思想を実装しますが、**機構設計**においては相当に異なります。まず 1inch から、個別に見ていき、その後で比較します。

## 1inch Fusion：古典的なダッチオークション {#1inch-fusion-the-classic-dutch-auction}

このプロトコルは「**シンプル・イズ・エレガント**」の原則を体現しています。
ここでは 1inch Fusion を使ったトランザクションの流れを分解します。注文は**3 つの数値**（開始価格、リザーブ価格、オークション時間）だけで構成され、最もクライアントに有利な価格から始まり、期間にわたり**直線的に**悲観的なリザーブ価格へ滑っていく**連続オークション**に掲載されます。オークション（現行版）は**クローズド**で、実行者は登録と KYC を通過する必要があります。掲載された注文に応じる参加者は、ユーザー署名済みの指示に従って、ユーザーのウォレットからトークンを**双方向エスクロー**に移し、そのオンチェーン取り込み時刻を厳密に記録させます。**最初にこれを行った者が落札**し、結果価格は注文パラメータとエスクロー開設時刻から**決定論的に**計算されます。以後、実行者は**排他期間**を享受し、その間にカウンター方向のエスクローへ、ユーザーが受け取るべきトークンを所定量入金して**自らの義務を履行**できます。最終ステップはエスクローの**クローズ**で、両方向に凍結された資金を同時に解放します。この最終ステップの手数料も、排他期間が切れる前に**実行者が負担**します。

> オークションや排他期間の具体的な時間枠はプロトコルで固定されておらず、サービス提供者に委ねられます。執筆時点では、1inch の案内・実務の双方で、**大多数のスワップは 5 分以内**に完了しています。

もし問題が生じ、実行者がユーザー資金を凍結したまま途中で停止した場合、排他期間の終了後にはエスクローのクローズ行為は**パブリック**になります。ネットワーク手数料を支払えば、**誰でも**（1）カウンターエスクローが十分に資金投入されていないときはユーザーのトークンを全額返却でき、（2）十分な資金があるのに実行者が技術的理由でクローズできないときはスワップを完遂できます。パブリックなクローズに経済的な意味を持たせるため、プロトコルは、実行者に対しユーザー資金の凍結と**並行して**わずかな**自己資金**をエスクローへボンドとして入れることを要求します――これは**ネットワーク手数料を賄える程度**の額です。これらの資金は**常に**エスクローのクローズに署名した者に支払われます。排他期間中は実行者に返還され、排他期間後はスワップの完了またはキャンセルを行った者の**報酬**になります。こうして、クライアントにとっては透明なまま、ニーズが満たされるのです。

## Uniswap X：2 段階の差別化オークション {#uniswap-x-a-two-stage-differentiated-auction}

こちらは**やや複雑**ですが、その理由は明快です。プロトコルは実行者を**2 つの不均等なグループ**に分け、**異なる段階**で行動させます。クライアントの注文に**最初に**関わるのは、登録・KYC 済みの **Quoter（クォーター；見積り提供者）**で、その作業はユーザーが何かに署名する**前**から始まっています。ユーザーがトレード方向を選び、希望数量（売る量または買う量）をフォームに入力すると、その注文の**下書き**が当該方向を担当するすべての Quoter にブロードキャストされます。各 Quoter は**きわめて迅速**（**概ね 0.5 秒以内**）に見積り――すなわち**相手側数量**――で応答することが求められます。ユーザーが一定量を**売る**なら、見積りは実行者が**支払う価格**。一定量を**買う**なら、実行者がそのトークンを**売る価格**です。

いずれの場合も、Quoter は**クライアントに最も有利な見積り**を巡って競争します。プラットフォームは勝者を選び、その見積りをスワップフォームに表示し、ユーザーに**支払い指示**への署名を促します。その瞬間から、勝者の Quoter は、**カウントダウン（30 秒）**が切れるまでにユーザーが署名すれば、その見積りを**履行する義務**を負います。この段階は勝者の Quoter に**排他的**です。署名済み指示の実行にもオンチェーンの期限が設けられ、それが切れると**不履行**とみなされ、注文は**排他段階の失敗**となります。期限までに約定を果たせなかった Quoter は、**一時的に**新規注文への見積り参加が**停止**されます。

> Uniswap の呼ぶこの初期クールダウン（“**fading**”）は**15 分**から始まり、**連続失敗ごとに指数関数的に延長**されます。ただし、各フェード終了後に**1 件でも成功**すると、ペナルティのエスカレーションは**リセット**されます。

**勝者が放棄**した注文だけが**第 2 段階**へ進みます。そこでは、前述の 1inch Fusion に酷似した、より典型的な**ダッチオークション**が行われます。ここでの最も重要な経済的差は、Uniswap X の第 2 段階が**登録不要で公開**されていることです。排他期間の終了からリザーブ価格に達するまでの間は、**誰でも**実行者（**Filler**）として行動でき、競争の一層の激化により最終スプレッドがさらに圧縮されるはずです。

この追加の複雑さは**無駄ではありません**。ユーザーが署名する**前**の段階で、**見えている価格**を履行する義務を Quoter に負わせることで、Uniswap X は、他では再現の難しい**優れた UX**を創り出します。比較のために言えば、1inch Fusion では署名時に見える為替レートは、プラットフォームによる**近似的で拘束力のない**見積りに過ぎません。最終価格は、開始価格とリザーブ価格の**どこか**で（時に長い）オークションの間に決まります。

![代替テキスト](/img/pocket-exchange/uniswapx-mainnet_flowchart.png)
*出典：[uniswap documentation](https://docs.uniswap.org/contracts/uniswapx/auctiontypes#ethereum-rfq--exclusive-dutch-auction)*

Uniswap X では**圧倒的多数**のケースで、ユーザーは「Approve and swap」を押した**直後**に実際に**送受信される数量**を見ながら署名を決めます。Quoter が完了に失敗する事例は比較的まれで、第 2 段階の公開ダッチオークションは**安全網**の役割を果たすに過ぎません。

定性的な経済分析から、この有用な機能が**無償**ではないことが示唆されます。Uniswap X で Quoter が負う**追加の義務とリスク**は、同じ名目上のスプレッドでも、**より保守的な収益期待**へと自然に彼らを向かわせます。ボラティリティの高いトークンが絡むスワップ（または通常は安定ペアでも相場が荒い期間）では、1inch Fusion の**古典的ダッチ**の方が、平均的にはクライアントの注文から**より小さな取り分**しか取らない可能性があります。

## 学び {#learnings}

Uniswap X 向けの自動マーケットメイカー（ボット）を経済面で助言した実務経験、および 1inch Fusion でのクロスチェーン取引機能プロトタイピング（ハッカソン）から得られた要点は次のとおりです。

プラットフォーム選択に関わらず、インテントベース・プロトコル向けの自動マーケットメイカーは、**機械的に非自明**な成果物です。その成否は、プラットフォーム連携という技術課題の解決だけでなく、**相互に関連する 2 つの経済的ポイント**を戦略で押さえられるかにかかっています。

第一に、ボットの有効性は、扱うペアに対して**見積りを素早く正確に価格付け**し、市況変化に**即応**してアルゴリズムを調整できる能力に**直結**します。最適な見積りを導くための**一次シグナル**の選択が極めて重要です。自然な候補は、**CEX のマーク価格**や**現物板の生データ**。これらは市場動向に**迅速**に反応する見積り推定を可能にします。

第二に、ボットの収益性を本気で最適化するには、**流動性リザーブの効率的管理**に細心の注意を払う必要があります。インテント系プロトコルは、実行者が市場の**あらゆるソース**から不足流動性を引っ張れるとはいえ、自前のウォレットに十分な**運転リザーブ**を維持することはトランザクションコストの大幅な削減につながります。

これらは**アルゴリズム**で扱うべき問題――つまり、**金銭判断をプログラムに委譲**する設計ですから、市場分析のための**データアクセス**が特に重要になります。伝統的な取引所では、参加者は情報取得の方法に応じて大別して 3 つ：**長期投資家**（ニュース等）、**デイトレーダー**（Nansen / Arkham / Etherscan のダッシュボード）、**HFT ロボット**（プラットフォームの**生 API**をリッスン）。インテント系の実行自動化は、データ要件の観点で**デイトレードと HFT の中間**に位置します。一方で、もはや**人間に全責任**を負わせられません。他方で、プロトコル内のタイミングは**現代の自動化基準では穏やか**です。最もタイトなのは Uniswap X の**見積り 0.5 秒**で、それ以外は**ブロック単位**（Ethereum なら**12 秒**）。HFT と異なり、イベント反応速度が**工学的な難題**にはなりません。12 秒という枠は十分に寛容で、これを落とすのは**設計や運用の重大なミス**でしょう。

したがって、**見積りの精度**と**流動性管理の最適化**の必要性が、オークションモデルにおいて自ずと浮かび上がります。**常により良い価格**を提示しながら**黒字を維持**できるボットが、**市場の収益を総取り**します。

このように**中間的**なデータ要求ゆえ、従来のデータソースにはいくつかの不都合があります。Nansen / Arkham / Etherscan のような**GUI ダッシュボード**は、主にデイトレ向けで、市場活動の射影は**限定的**。急変環境での特定意思決定の支援という利便性は否めない一方、アルゴリズムのパラメータを磨くための**精緻な統計研究**には向きません。手作業では扱い切れない**大規模データの集計・フィルタ**が必要になり、テンプレ GUI の利用は**実務的でない**のです。

逆に、**生の**ブロックチェーン API や取引プラットフォームを使うと、自動化の自由は得られるものの、統計研究はたちまち「**干し草の山から針探し**」の**別個のエンジニアリング課題**に化けます。最も手軽だが単調なツールのひとつが [Etherscan](https://etherscan.io/) でしょう。Etherscan はトランザクション、ウォレット、コントラクトの大量のデータを提供しますが、**特定のアドレスの正体**などを事前に把握していないと、**苛立たしい**体験になりがちです（干し草＝膨大な情報、針＝求める精密な詳細）。本件文脈では、Uniswap X の特定 Filler のトランザクションを見るなど、**ピンポイント**用途に向いています。結局、エコノミストの机に届く前に、データは**有能なデータサイエンティスト**の手で、低レベル API から噴出する**デジタル鉱滓**の山から**有益な粒**を抽出する工程を経るのが必然です。幸いにも、**Dune** の存在により、この問題は**部分的に回避**できます。

## モニタリング & データ取得 {#monitoring--data-acquisition}

ここで、[Dune](https://dune.com/) プラットフォームが**方法論的な “スイートスポット”**として登場します。プラットフォーム自身が**データ取り込み・デコード・構造化**という巨大なエンジニアリング作業を担い、アナリストは精製済みデータに対する**粒度の高いクエリ能力**を保持できるのです。

Dune では誰でも**公開/非公開**ダッシュボードを作成でき、表面上はオンチェーン取引データを使った**可視化**が中心に見えます。まずはこの表層から、仕組みの**実用**へと掘り下げます。

私たちのリサーチ段階では、Uniswap X の Filler 活動を**容易に**追跡できる公開ダッシュボードは**ほとんどなく**、実質的に**信頼できるものは 1 つ**だけでした。

[@flashbots による Uniswap X のダッシュボード](https://dune.com/flashbots/uniswap-x)には、アクティブな Filler に加え、ボリューム、注文サイズ、Filler、トランザクションハッシュなどの重要情報が並びます。

> このダッシュボードは廃止されている、あるいは更新が滞っている可能性があります

いくつかの公開データを見てみましょう。
デフォルトで 2 つのビューがあり、上部は**週間統計**、下部は**累積**です。

まずは週間ビューに注目します。
![代替テキスト](/img/pocket-exchange/weekly-dashboard-view.png)

トレードの**種類**（および**方向**）を把握するのに最も有用なクエリが、[Top 10 Volume Tokens Grouped by Filler](https://dune.com/queries/3053887/5081486) です。これで上位ウォレット（Filler）が分かるだけでなく、**最大ボリューム**の取引が **USDC と WETH**（Wrapped Ethereum）ペアで発生していることが明確に見て取れます。

![代替テキスト](/img/pocket-exchange/Top-10-Volume-Tokens-Grouped-by-Filler.png)

> Wrapped Ethereum（wETH）は、Ethereum（ETH）を 1:1 で表現する ERC-20 トークンで、DeFi アプリや ERC-20 準拠プラットフォームでの互換性をもたらします。ETH は Ethereum のネイティブ通貨ですが ERC-20 トークンではないため、多くの dApp ではそのまま使えません。

ただし、このダッシュボードは有用ではあるものの、現状では Uniswap X 向けの**洗練された自動マーケットメイカー（ボット）**の要件を**すべて**満たしてはいません。Filler の**推定 ROI**、**トランザクションコスト**、**ポートフォリオ履歴**や**配分**といった基本指標でさえ、ここから**容易には**得られません。さらに**リスク管理**、**流動性調達**、**パフォーマンス分析**といった**より複雑な概念**へ抽象化する場合、**精密に洗練された**アプローチが必要です。

Dune の**サーバーサイド SQL**モデルは、データアクセスの**「ゴルディロックス・ゾーン」**を提供します。その抽象度は次のとおりです。

* **Raw API より高い**：アナリストは 16 進ログのデコード、トークン小数の調整、複雑なインデキシング・パイプラインの構築を行う必要がありません。データはすでに**正規化**され、`erc20.transfers` や `dex.trades` といった**関係テーブル**で提供されます。
* **GUI ダッシュボードより低くて豊富**：Nansen や Arkham の**事前構築ビュー**とは異なり、Dune は**基盤データ**へ直接アクセスさせます。問える質問に**人工的制限**はありません。アナリストは**独自の手数料ボラティリティ指標**を算出し、**3 つのプロトコルに跨る流動性提供の相関**を取り、**新しい MEV 戦略の収益性**を**単一の SQL**でモデル化できます。

この能力は単なる利便ではなく、**インテント系システムの経済設計**にとっての根本的な**推進力**です。これらのプロトコルで重要なのは、純粋な実行速度ではなく**経済最適化**へとシフトします。ソルバー（実行者）の収益性――ひいてはネットワーク全体の健全性――は、彼らが次をどれだけうまくやれるかにかかっています。

1. **リスクと機会の精密価格付け**：現スポット価格以上の情報が必要です。競合ソルバーが**より良いルート**を見つける確率、**大口スワップ**が次ブロックで市場を動かす確率、**不履行**の**暗黙コスト**。これには DEX、レンディング、ブリッジのデータを結合する**複合クエリ**が必要です。
2. **流動性調達の最適化**：オークションモデルの**勝者総取り**に近いダイナミクスでは、流動性調達の**限界改善**が最重要です。ソルバーは**プールやチェーンを跨いだ分断流動性**を分析し、**ガスコスト**をモデル化し、ユーザーのインテントと束ねられる**アービトラージ機会**を特定して、より競争的な見積りを提示します。これは**統合的課題**で、**静的ダッシュボード**には不向き、**探索的 SQL**には最適です。
3. **事後分析と競合解析**：特定の注文を**なぜ競合が勝ったのか**？ その見積りが**異常に良かった**のは**新奇ルーティング**の示唆か？ 過去の任意ブロック時点の市場状況を再生し、**競合ソルバーのオンチェーン行動**をクエリすることで、成功戦略を**リバースエンジニアリング**し、自身のモデルの弱点を炙り出せます。これは Dune の**履歴データ**で**標準的に**可能です。

要するに、Dune は**経済 R&D の計算基盤**です。大企業の専有データ基盤が独占していたような**深い定量分析**を、少人数の研究・開発チームでも行えるようにします。サーバーサイド SQL の威力と利便を示すため、たとえば**Uniswap X のトランザクション集計による ROI 分析**に用いた[メインの SQL クエリ](https://dune.com/queries/5383565)（[このラッパー](https://dune.com/queries/5382736)でパラメタ化・フィルタ）を挙げられます。以下では、**GUI ダッシュボード**や**Raw API**では極めて難しい、しかし Dune では容易な意味要素を分解します。

![代替テキスト](/img/pocket-exchange/main-sql-query.png)

### クエリの構成要素とその意味 {#the-query-parts--their-significance}

**パート A：`get_transfers` CTE ― トークン転送とネイティブ ETH の統合処理**

```sql
WITH
  get_transfers AS (
    SELECT ... FROM erc20_ethereum.evt_Transfer ...
    UNION ALL
    SELECT ... FROM ethereum.traces ...
  )
```

* **目的**：各トランザクションにおける**トークン転送（ERC‑20）**と**ネイティブ ETH 転送**を**統一ビュー**化します。経済分析では**両方**の資産移動を考慮する必要があります。
* **利点（例）**：**生データの自動デコード**。

  * **Raw API**なら：

    1. すべての**トランザクションレシート**を取得し、**ABI** で 16 進ログを**デコード**して ERC‑20 転送を識別。
    2. `ethereum.traces` で `value` を持つ `CALL` を**別途解析**してネイティブ ETH 移動を抽出。
    3. 構造の異なるデータを**手作業で突合**し**統合**。
  * **Dune**なら：`erc20_ethereum.evt_Transfer` と `ethereum.traces` が**前処理済み・標準化済み**。**正規化の重労働**は不要です。

**パート B：`logs` CTE ― プロトコルイベントの集約**

```sql
  logs AS (
    SELECT * FROM uniswap_ethereum.V2DutchOrderReactor_evt_Fill ...
    UNION ALL
    SELECT * FROM uniswap_ethereum.ExclusiveDutchOrderReactor_evt_Fill ...
  )
```

* **目的**：Uniswap X の**異なるバージョン**のスマートコントラクトから `Fill` イベントを**合算**します。
* **利点**：**コントラクト差異や版の抽象化**。

  * **GUI**では：「Uniswap のボリューム」は見えても、「**Filler の収益性**」のような**特化ビュー**、ましてや**複数契約版の統合**はほぼ不可能。
  * **Dune**なら：**低レベルのイベント**が**可読テーブル**で用意され、**簡単に統合**できます。**アドレスや ABI** を暗記する必要はありません。

**パート C：`txs_with_evt_fill` CTE ― ラベルと価格によるトランザクション拡充**

```sql
      JOIN ethereum.transactions tx ON x.evt_tx_hash = tx.hash
      LEFT JOIN prices.usd pu ON ... -- TX 手数料の USD 評価
      LEFT JOIN query_2812729 labels ON x.filler = labels.address -- Filler ラベル
```

* **目的**：**手数料（ガス）**、**USD 評価**、**ラベル**を結合し、**実体を伴った**トランザクションにします。
* **利点**：**その場でのデータ拡充**。

  * **Raw API**なら：手数料の USD 化には、**当該ブロック時刻の ETH 価格**を**別 API**から取得して**手組み JOIN**。
  * **ラベリング問題**：Arkham のような GUI では「誰か」をプロプライエタリに扱いますが、Dune では**民主化**されています。`query_2812729` は**コミュニティ主導**のラベル集で、誰でも**参照・フォーク・貢献**可能。**秘伝のタレ**を**公共財**へ。

**パート D：`get_swapper_txs` CTE と後続集計 ― ビジネスロジックの核**

```sql
CASE WHEN transfers."to" = fill.swapper THEN true ... END as to_swapper
...
CASE transfers."to" WHEN 0x000000fee13a103A10D593b9AE06b3e05F2E7E1c THEN true ... END as to_uniswap
```

* **目的**：トランザクション内の**すべての資産フロー**を**経済的に**分類します。

  * **スワッパーから送信**（インプット）
  * **スワッパーへ送信**（アウトプット）
  * **既知の Uniswap 手数料アドレスへ送信**（プロトコル手数料/LP リワード）
* **利点**：**独自の経済モデル**を**SQL で直接表現**。

  * **GUI**では：**既定メトリクス**（ボリューム、TVL 等）に**縛られる**。**Filler の純利益**（スプレッドから**手数料とガス**を差し引く）などは**困難**。
  * **Dune**なら：`CASE` と `SUM` の**組み合わせ**で**即実装**できます。

**パート E：ラッパークエリ ― パラメタ化とフィルタ**

```sql
from "query_5383565(days_num='60')"
where contains(array[ 'DAI-USDT', 'DAI-USDC' ... ], token_pair)
```

* **目的**：複雑なメインクエリを**再利用可能なデータソース**にし、**期間**や**銘柄ペア**を**引数**・**フィルタ**で切り替え可能にします。
* **利点**：**合成性と再利用性**。一度作った深い分析を、**他期間・他ペア**へ**手直しなし**で展開できます。

### 結論：「サーバーサイド SQL」の価値提案 {#conclusion-the-server-side-sql-value-proposition}

この**単一クエリ**は、前述の「**中間位置**」に**ぴたり**とハマるタスクを処理します。これは**既製 GUI**に載せるには**複雑すぎ**、**Raw API**でやるなら**数週間のエンジニアリング**（デコード、価格フィード、ラベリングのパイプライン構築）が必要です。

**Dune では、たった 1 人のアナリストで扱えます。**

この方法論により、研究者は**経済ロジック**（`CASE`、`JOIN`、`SUM`）に**完全に集中**でき、**データ配管**（ログデコード、価格取得、小数管理）に気を取られません。これこそが**サーバーサイド SQL**の究極の便益です。ブロックチェーンは**オープン**でデータは豊富ですが、**意味を与える**のは容易ではありません。
私たちはリサーチ期間を通じて、特に Uniswap X の Filler のトランザクションや活動を監視するために、**複数のリソース**を使い、また作成しました。本件ではクライアントの要望により、対象を**Ethereum メインネット**に限定しました。**数理モデルや完全なデータセット、最終成果**は共有できませんが、この種の**モニタリング/取得**で何が重要か、**方法**と**理由**を解説することで、複雑なシステムの構築・研究に関する一端を示せたと考えます。

## 好機をつかむ：研究から収益へ {#seizing-the-opportunity-from-research-to-revenue}

アーキテクチャの観点から、効率的な自動マーケットメイキング・ボットの複雑さを説明してきました。ここで、それが**適切な指導と支援**のもとで**どのような収益機会**を開くかに触れます。**理解**と**実運用**は全く別物です。

総スワップ数は当初の調査時点に比べて**増加**しているようですが、**ユニーク Filler 数**はそれに**比例して増えて**はいません。

これは、**既存の洗練された Filler**が、**ほとんど競合なく**拡大する利益を**取り込んでいる**ことを意味します。

オンチェーンのマーケットメイカーと競う難しさは、情報取得の方法だけではありません。**予算**、**ポートフォリオ管理**、**インフラ要件**など、効率的なボットを**実際にデプロイ**するための考慮事項が多々あります。

私たちは、Uniswap X のようなマーケットメイキング・プラットフォームに参加する際の**高い参入障壁**を、**研究と経験**によって**下げる**ことができます。

私たちのチームは、**リサーチとコンサルティング**を通じて、**正しい方向**へ導きます。クライアントのビジョンを実現するための**研究**と**ツール**は、すでに**整っています**。

示したとおり、参入障壁は**資本**ではありません。**莫大な技術的・経済的複雑性**です。成功するマーケットメイキング運用には次が必要です。

* **正確な価格付け**：**サブ秒**のリアルタイム・リスク/プライシング・アルゴリズム
* **最適化された流動性**：多様なソースからの**効率的な調達戦略**
* **堅牢なインフラ**：**500ms 未満**で見積り応答し続ける**24/7 高可用**システム
* **継続的 R&D**：競合戦略をモデル化する**継続的な深いデータ分析**

これを**ゼロから**構築するのは、長く高コストな R&D の挑戦です。**R&D は、私たちがすでに完了**しています。

私たちは**画一的なボット**を提供しません。**ファンド**や**大口資本プレイヤー**と提携し、**専有リサーチ**を活用した**カスタムのマーケットメイキング・ソリューション**を設計・構築・デプロイします。

**資本**と**戦略的ビジョン**をご提供ください。**エンジンを作る専門チーム**は私たちが提供します。

このパートナーシップは、ゼロから始める場合に比べ、**時間とコストを大幅に節約**して市場投入へ導きます。私たちは次を共創します。

* **カスタム戦略**：リスク許容度と資本規模に合わせて、専有アルゴリズムを**設計・モデル化・デプロイ**
* **専用データ & アナリティクス**：**公開クエリを超える**真の優位性をもたらす、**専用のリアルタイムダッシュボード**と**データパイプライン**
* **カスタム・ポートフォリオ自動化**：流動性リザーブの効率的管理、ヘッジ、リバランスのための**自動化ツール**

## 研究チームではなく、市場のリーダーに。 {#become-a-market-leader-not-a-research-team}

私たちの**完了済みリサーチ**の上に構築すれば、**過酷な R&D フェーズ**を回避し、**機関投資家グレード**のシステム構築へ**直行**できます。

私たちは**一流 Web3 プロトコル**の**信頼できる R&D チーム**であり、同じレベルの**機関グレードの専門性**を**マーケットメイキングのクライアント**にも提供します。

チャンスの窓は**今**開いていますが、長くは続きません。**研究フェーズに予算を費やさないでください**。

[今すぐプライベート相談](https://www.inferara.com/en/contact/)にお申し込みいただき、**高性能なカスタム・マーケットメイキング・ボット**の構築についてご相談ください。
